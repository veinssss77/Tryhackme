1. Endpoint Detection and Response (EDR)
1.1 Definition

Endpoint Detection and Response (EDR) is a security solution designed to continuously monitor endpoint devices (workstations, servers, laptops) to detect, investigate, and respond to suspicious or malicious activities.

Unlike traditional antivirus, EDR focuses on behavioral detection rather than just signature-based detection.

1.2 Why EDR Exists

Traditional antivirus:

Detects known malware via signatures.

Limited visibility into attack chains.

Weak against fileless malware and advanced persistent threats (APTs).

EDR was developed to:

Provide continuous monitoring.

Detect advanced and unknown threats.

Enable rapid investigation and response.

1.3 Core Capabilities of EDR
1. Continuous Monitoring

Collects endpoint telemetry:

Process creation

Command-line arguments

File modifications

Registry changes

Network connections

Sends this data to a centralized console.

2. Threat Detection

Uses:

Behavioral analysis

Indicators of Compromise (IOCs)

Machine learning models

Detects:

Fileless attacks

Suspicious PowerShell usage

Lateral movement attempts

3. Alerting

Generates alerts when suspicious behavior matches rules or anomalies.

Provides context:

Parent process

User account

Hash values

Network connections

4. Response Actions

Typical response actions include:

Kill process

Quarantine file

Isolate endpoint from network

Collect forensic artifacts

Rollback malicious changes (in some tools)

1.4 EDR Workflow in a SOC

Endpoint agent collects telemetry.

Suspicious behavior is detected.

Alert is sent to SOC dashboard.

Analyst investigates process tree and timeline.

Analyst takes containment action if malicious.

1.5 EDR vs Antivirus vs XDR
Feature	Antivirus	EDR	XDR
Detection	Signature-based	Behavioral + signature	Cross-domain (endpoint, network, cloud)
Visibility	Limited	Deep endpoint visibility	Enterprise-wide
Response	Basic	Advanced containment	Coordinated across tools
2. Security Information and Event Management (SIEM)
2.1 Definition

SIEM (Security Information and Event Management) is a system that aggregates, correlates, analyzes, and stores logs from multiple sources to detect security incidents.

It acts as the central visibility layer of a SOC.

2.2 What SIEM Collects

Firewall logs

IDS/IPS logs

Server logs

Windows Event Logs

Linux logs

EDR alerts

Application logs

Authentication logs (Active Directory, VPN)

2.3 SIEM Core Functions
1. Log Collection

Centralizes logs from multiple devices.

Uses agents, syslog, APIs.

2. Normalization

Converts logs into a standardized format.

Enables cross-device correlation.

3. Correlation

Links multiple events together.
Example:

Multiple failed logins

Followed by successful login

Followed by privilege escalation

4. Alerting

Rule-based alerts.

Threshold alerts.

Behavioral alerts.

5. Reporting and Compliance

Generates compliance reports (ISO, PCI-DSS, etc.).

Provides audit trails.

2.4 SIEM Workflow in a SOC

Logs are ingested.

SIEM parses and indexes logs.

Correlation rules evaluate events.

Alerts are triggered.

Analysts triage alerts.

Escalation or response occurs.

2.5 Why SIEM is Critical

Centralized visibility.

Detects multi-stage attacks.

Enables forensic investigations.

Provides historical log retention.

3. Splunk – The Basics
3.1 What is Splunk?

Splunk is a data platform used for searching, monitoring, and analyzing machine-generated data. In cybersecurity, it is widely used as a SIEM platform (especially with Splunk Enterprise Security).

3.2 Splunk Architecture
1. Universal Forwarder

Lightweight agent.

Installed on endpoints.

Sends logs to Splunk indexer.

2. Indexer

Parses and indexes incoming logs.

Stores data.

Makes data searchable.

3. Search Head

Web interface for analysts.

Used to:

Search logs

Build dashboards

Create alerts

3.3 Splunk Search Processing Language (SPL)

SPL is used to query logs.

Basic example:

index=windows EventCode=4625

This searches for failed login attempts.

SPL allows:

Filtering

Aggregation

Statistical analysis

Time-based queries

3.4 Common SOC Use Cases in Splunk

Investigate brute force attacks.

Detect suspicious PowerShell usage.

Correlate firewall logs with endpoint alerts.

Build dashboards for threat trends.

3.5 Strengths

Powerful search language.

Scalable.

Real-time analytics.

Extensive integrations.

4. Elastic Stack (ELK) – The Basics
4.1 What is the Elastic Stack?

The Elastic Stack (formerly ELK) consists of:

Elasticsearch

Logstash

Kibana

It is used for log ingestion, storage, search, and visualization.

4.2 Components
1. Elasticsearch

Distributed search and analytics engine.

Stores and indexes logs.

Enables fast querying.

2. Logstash

Log ingestion and processing pipeline.

Parses and transforms raw logs.

3. Kibana

Web interface.

Used for:

Searching logs

Creating dashboards

Visualizing trends

4. Beats

Lightweight log shippers.

Installed on endpoints or servers.

4.3 ELK Workflow

Beats collect logs.

Logs sent to Logstash.

Logstash processes logs.

Logs stored in Elasticsearch.

Analysts query and visualize in Kibana.

4.4 Elastic Stack as SIEM

By default, ELK is a log platform.

With:

Detection rules

Security add-ons

Alerting modules

It can function as a SIEM.

4.5 Comparison with Splunk
Feature	Splunk	Elastic Stack
Cost	Commercial	Open-source core
Setup	Easier	More manual setup
Customization	High	Very high
Learning curve	Moderate	Higher initially
5. Security Orchestration, Automation, and Response (SOAR)
5.1 Definition

SOAR integrates security tools and automates incident response workflows to improve efficiency and reduce response time.

It works closely with SIEM and EDR.

5.2 Core Components
1. Orchestration

Connects multiple security tools.

Allows them to work together.

Example:

SIEM + EDR + Ticketing system.

2. Automation

Executes predefined actions automatically.

Reduces manual repetitive tasks.

Example:

Auto-block malicious IP.

Auto-isolate infected machine.

3. Response

Standardizes incident handling via playbooks.

Ensures consistent response procedures.

5.3 What is a Playbook?

A playbook is a predefined workflow.

Example:

Receive SIEM alert.

Enrich with threat intelligence.

Check asset criticality.

Isolate endpoint if malicious.

Create ticket.

Notify analyst.

5.4 Benefits of SOAR

Reduces Mean Time To Respond (MTTR).

Reduces alert fatigue.

Standardizes investigation processes.

Improves SOC efficiency.

6. How All Core SOC Solutions Work Together

Example Incident Flow:

EDR detects suspicious PowerShell activity.

Alert sent to SIEM.

SIEM correlates with failed login attempts.

Alert triggered to SOC.

SOAR playbook runs:

Enrich alert

Isolate endpoint

Open incident ticket

Analyst performs investigation in Splunk or Elastic.

7. Quick Revision Summary

EDR:

Endpoint-level monitoring and response.

SIEM:

Central log aggregation and correlation.

Splunk:

Commercial SIEM platform with powerful SPL.

Elastic Stack:

Open-source log platform used for SIEM-like functions.

SOAR:

Automates and orchestrates incident response.
